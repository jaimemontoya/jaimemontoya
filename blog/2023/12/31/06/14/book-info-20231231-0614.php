<?php
  $index->content .= 
           "<p>I wanted to perform multidimensional analysis on the information in my personal finance data mart. In order to achieve that, I needed to define an OLAP cube on top of that database.</p><p>I opened Visual Studio 2017:</p><div><img src=\"/blog/2023/12/31/06/14/img/openVisualStudio2017.jpg\" alt=\"Open Visual Studio 2017\" width=\"584\" height=\"681\"></div><p>I had installed Microsoft Visual Studio Community 2017 Version 15.9.49:</p><div><img src=\"/blog/2023/12/31/06/14/img/showInstalledVersionOfVisualStudio.jpg\" alt=\"Show installed version of Visual Studio\" width=\"755\" height=\"561\"></div><p>I clicked <span class=\"cod\">Project...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickProject.jpg\" alt=\"Click Project...\" width=\"633\" height=\"415\"></div><p>I selected </p><span class=\"cod\">Analysis Services Multidimensional and Data Mining Project</span>. I entered <span class=\"cod\">FinancesDM</span> for the <span class=\"cod\">Name</span> and set the <span class=\"cod\">Location</span> to where I wanted to store the project. I clicked OK to create the project:</p><div><img src=\"/blog/2023/12/31/06/14/img/createProject.jpg\" alt=\"Create Project\" width=\"1300\" height=\"766\"></div><p>I right-clicked the <span class=\"cod\">Data Sources</span> folder in the <span class=\"cod\">Solution Explorer</span> window, and selected <span class=\"cod\">New Data Source...</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNewDataSource.jpg\" alt=\"Create new Data Source\" width=\"1918\" height=\"1030\"></div><p>The <span class=\"cod\">Data Source Wizard</span> appeared:</p><div><img src=\"/blog/2023/12/31/06/14/img/dataSourceWizard.jpg\" alt=\"Data Source Wizard\" width=\"1912\" height=\"742\"></div><p>I clicked <span class=\"cod\">Next</span> on the <span class=\"cod\">Welcome to the Data Source Wizard</span> page. The <span class=\"cod\">Select how to define the connection</span> page appeared. I selected <span class=\"cod\">Create a data source based on an existing or new connection</span> and clicked <span class=\"cod\">New...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/createDataSourceBasedOnNewConnection.jpg\" alt=\"Create Data Source based on new connection\" width=\"620\" height=\"447\"></div><p>I provided my server and database settings corresponding to the data mart that I wanted to use:</p><div><img src=\"/blog/2023/12/31/06/14/img/dataMartServerAndDatabaseSettings.jpg\" alt=\"Data mart server and database settings\" width=\"643\" height=\"649\"></div><p>I selected the <span class=\"cod\">PDDMNB955.Finances.jaimemontoya</span> data connection I previously created, and clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectConnectionPreviouslyCreated.jpg\" alt=\"Select Connection previously created\" width=\"619\" height=\"445\"></div><p>The <span class=\"cod\">Impersonation Information</span> page appeared. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/ignoreImpersonationAndClickNext.jpg\" alt=\"Ignore Impersonation and click Next\" width=\"619\" height=\"445\"></div><p>I entered <span class=\"cod\">FinancesDM</span> for <span class=\"cod\">Data source name</span> and clicked <span class=\"cod\">Finish</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/finishCreationOfNewDataSource.jpg\" alt=\"Finish creation of new Data Source\" width=\"618\" height=\"446\"></div><p>The Data Source for my project was created successfully:</p><div><img src=\"/blog/2023/12/31/06/14/img/newDataSourceCreatedSuccessfully.jpg\" alt=\"New Data Source created successfully\" width=\"1910\" height=\"367\"></div><p>I right-clicked the <span class=\"cod\">Data Source Views</span> folder in the <span class=\"cod\">Solution Explorer</span> window, and selected </span>New Data Source View...</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNewDataSourceView.jpg\" alt=\"Create new Data Source View\" width=\"1916\" height=\"1030\"></div><p>The <span class=\"cod\">Data Source View Wizard</span> appeared. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/showDataSourceViewWizard.jpg\" alt=\"Show Data Source View Wizard\" width=\"1910\" height=\"1020\"></div><p>The <span class=\"cod\">Select a Data Source</span> page appeared. The FinacesDM data source that I created was selected. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectADataSourceForTheView.jpg\" alt=\"Select a Data Source for the View\" width=\"558\" height=\"444\"></div><p>The <span class=\"cod\">Select Tables and Views</span> page appeared.  I moved all of the dimension and fact tables to the <span class=\"cod\">Included objects</span> list by clicking the <span class=\"cod\">>></span> button. I had two fact tables in my list:</p><div><img src=\"/blog/2023/12/31/06/14/img/moveTablesAndViewsToIncludedObjects.jpg\" alt=\"Move Tables and Views to Included objects\" width=\"621\" height=\"629\"></div><p>After moving the objects, I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/continueAfterMovingObjects.jpg\" alt=\"Continue after moving objects\" width=\"620\" height=\"627\"></div><p>The <span class=\"cod\">Completing the Wizard</span> page appeared. I entered <span class=\"cod\">FinancesDM</span> for <span class=\"cod\">Name</span>. I clicked <span class=\"cod\">Finish</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/finishCreationOfDataSourceView.jpg\" alt=\"Finish creation of Data Source View\" width=\"620\" height=\"626\"></div><p>My View was created successfully:</p><div><img src=\"/blog/2023/12/31/06/14/img/viewCreatedSuccessfully.jpg\" alt=\"View created successfully\" width=\"1915\" height=\"1027\"></div><p>I right-clicked the <span class=\"cod\">Cubes</span> folder in the <span class=\"cod\">Solution Explorer</span> window, and selected <span class=\"cod\">New Cube</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNewCube.jpg\" alt=\"Create new Cube\" width=\"1917\" height=\"1030\"></div><p>The <span class=\"cod\">Cube Wizard</span> appeared. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/cubeWizard.jpg\" alt=\"Cube Wizard\" width=\"1910\" height=\"1027\"></div><p>The <span class=\"cod\">Select Creation Method</span> page appeared. I kept <span class=\"cod\">Use existing tables</span> selected. Then I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/useExistingTables.jpg\" alt=\"Use existing tables\" width=\"555\" height=\"442\"></div><p>The <span class=\"cod\">Select Measure Group Tables</span> page appeared. The <span class=\"cod\">FinancesDM</span> data source view that I created was selected. I checked <span class=\"cod\">FactPurchases</span> in the <span class=\"cod\">Measure group tables</span> area. I initially left the measures in the <span class=\"cod\">FactSales</span>, <span class=\"cod\">FactPurchasesXDimCategory</span> and <span class=\"cod\">FactSalesXDimCategory</span> tables out of the cube to add them in at a later time. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectMeasureGroupTable.jpg\" alt=\"Select Measure Group Table\" width=\"557\" height=\"520\"></div><p>The <span class=\"cod\">Select Measures</span> page appeared. The wizard found and checked the measure field in the <span class=\"cod\">FactPurchases</span> table. The wizard also added a field called <span class=\"cod\">Fact Purchases Count</span>, which counts the number of records. This does not provide me with any useful information in this data mart, so I unchecked the <span class=\"cod\">Fact Purchases Count</span> field. I clicked <span class=\"cod\">Next</span>: </p><div><img src=\"/blog/2023/12/31/06/14/img/selectMeasures.jpg\" alt=\"Select Measures\" width=\"556\" height=\"518\"></div><p>The <span class=\"cod\">Select New Dimensions</span> page appeared. The wizard found all of the tables related to the <span class=\"cod\">FactPurchases</span> table in the data source view. It also created hierarchies for the <span class=\"cod\">DimCity</span>, <span class=\"cod\">DimPaymentMethod</span>, and <span class=\"cod\">DimCategory</span> dimensions. I unchecked <span class=\"cod\">Fact Purchases</span> and <span class=\"cod\">FactPurchases</span>. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectNewDimensions.jpg\" alt=\"Select new Dimensions\" width=\"556\" height=\"519\"></div><p>The <span class=\"cod\">Completing the Wizard</span> page appeared. I kept <span class=\"cod\">FinancesDM</span> for <span class=\"cod\">Cube name</span>. Then I clicked <span class=\"cod\">Finish</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/completingTheCubeWizard.jpg\" alt=\"Completing the Cube Wizard\" width=\"555\" height=\"518\"></div><p>My Cube was created successfully:</p><div><img src=\"/blog/2023/12/31/06/14/img/cubeCreatedSuccessfully.jpg\" alt=\"Cube created successfully\" width=\"1912\" height=\"1028\"></div><p>I right-clicked the <span class=\"cod\">FinancesDM.cube</span> and then clicked <span class=\"cod\">Process...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/processCube.jpg\" alt=\"Process Cube\" width=\"1920\" height=\"1030\"></div><p>I clicked <span class=\"cod\">Yes</span> to build and deploy the project:</p><div><img src=\"/blog/2023/12/31/06/14/img/buildAndDeployCube.jpg\" alt=\"Build and deploy Cube\" width=\"1915\" height=\"1028\"></div><p>I received the following error message. I clicked <span class=\"cod\">Yes</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/continueBuildingAndDeployingEvenWithErrors.jpg\" alt=\"Continue building and deploying even with errors\" width=\"1915\" height=\"1024\"></div><p>I received the following error:</p><div><img src=\"/blog/2023/12/31/06/14/img/cubeNotFoundError.jpg\" alt=\"Cube not found error\" width=\"1916\" height=\"1027\"></div><p>The error message that I see reveals the root cause of the problem: <span class=\"cod\">The deployment has been cancelled because data source impersonation information was not supplied.</span>, as shown below:</p><div><img src=\"/blog/2023/12/31/06/14/img/rootCauseOfProblem.jpg\" alt=\"Root cause of problem\" width=\"1913\" height=\"1026\"></div><p>I right-clicked <span class=\"cod\">FinancesDM.ds</span> and then clicked <span class=\"cod\">View Designer</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/viewDesigner.jpg\" alt=\"Go to View Designer\" width=\"1919\" height=\"1027\"></div><p>From the <span class=\"cod\">Impersonation Information</span> tab, I changed my selection from <span class=\"cod\">Use a specific Windows user name and password</span> to <span class=\"cod\">Use the service account</span>. Then I clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/changeImpersonationInformation.jpg\" alt=\"Change Impersonation Information\" width=\"1913\" height=\"1029\"></div><p>I tried to process the cube again (as shown in previous steps). From the <span class=\"cod\">Process Cube</span> window, I clicked <span class=\"cod\">Run...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/runProcessingOfCube.jpg\" alt=\"Run processing of Cube\" width=\"1911\" height=\"1026\"></div><p>The process succeeded:</p><div><img src=\"/blog/2023/12/31/06/14/img/SuccessProcessingCube.jpg\" alt=\"Success processing Cube\" width=\"1916\" height=\"1024\"></div><p>I right-clicked <span class=\"cod\">FinancesDM.cube</span> and then clicked <span class=\"cod\">Browse</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/browseCube.jpg\" alt=\"Browse Cube\" width=\"1919\" height=\"1030\"></div><p>I was able to browse my cube:</p><div><img src=\"/blog/2023/12/31/06/14/img/browseCubeUsingMultipleDimensions.jpg\" alt=\"Browse cube using multiple dimensions\" width=\"1915\" height=\"1030\"></div><p>I right-clicked the <span class=\"cod\">Dimensions</span> entry in the <span class=\"cod\">Solution Explorer</span> window, and selected <span class=\"cod\">New Dimension</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNewDimension.jpg\" alt=\"Create new Dimension\" width=\"1896\" height=\"1005\"></div><p>The <span class=\"cod\">Dimension Wizard</span> dialog box appeared. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/dimensionWizard.jpg\" alt=\"Dimension Wizard\" width=\"1913\" height=\"1028\"></div><p>The <span class=\"cod\">Select Creation Method</span> page of the wizard appeared. I left the <span class=\"cod\">Use an existing table</span> item selected and clicked <span class=\"cod\">Next</span>: </p><div><img src=\"/blog/2023/12/31/06/14/img/useExistingTableToCreateNewDimension.jpg\" alt=\"Use existing table to create new Dimension\" width=\"556\" height=\"443\"></div><p>The <span class=\"cod\">Specify Source Information</span> page appeared. The FinancesDM data source view was already selected. I selected <span class=\"cod\">DimDay</span> from the <span class=\"cod\">Main table</span> drop-down list. <span class=\"cod\">DayID</span> was selected as the first and oly <span class=\"cod\">Key column</span>. I selected <span class=\"cod\">DayID</span> from the drop-down list at the bottom. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/specifyDataSourceInformationForNewDimension.jpg\" alt=\"Specify Data Source Information for new Dimension\" width=\"557\" height=\"640\"></div><p>The <span class=\"cod\">Select Dimension Attributes</span> page appeared.</p><p>I left <span class=\"cod\">Day ID</span> checked and also checked <span class=\"cod\">Calendar Year</span>, <span class=\"cod\">Calendar Quarter</span>, <span class=\"cod\">Calendar Month</span>, <span class=\"cod\">Calendar Semester</span>, and <span class=\"cod\">Day Of Week</span>. I clicked in the <span class=\"cod\">Attribute Type column</span> across from <span class=\"cod\">Day ID</span>. I clicked the drop-down arrow. I expanded the <span class=\"cod\">Date</span> entry. I expanded the <span class=\"cod\">Calendar</span> entry. I selected <span class=\"cod\">Date</span> and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectDateAsAttributeType.jpg\" alt=\"Select Date as Attribute Type\" width=\"1914\" height=\"1030\"></div><p>I clicked in the <span class=\"cod\">Attribute Type</span> column across from <span class=\"cod\">Calendar Quarter</span>. I clicked the drop-down arrow. I expanded the <span class=\"cod\">Date</span> entry. I expanded the <span class=\"cod\">Calendar</span> entry. I selected <span class=\"cod\">Quarter</span> and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectQuarter.jpg\" alt=\"Select Quarter\" width=\"615\" height=\"735\"></div><p>I clicked in the <span class=\"cod\">Attribute Type</span> column across from <span class=\"cod\">Calendar Year</span>. I clicked the drop-down arrow. I expanded the <span class=\"cod\">Date</span> entry. I expanded the <span class=\"cod\">Calendar</span> entry. I selected <span class=\"cod\">Year</span> and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectYearAttributeType.jpg\" alt=\"Select Year attribute Type\" width=\"614\" height=\"734\"></div><p>I clicked in the <span class=\"cod\">Attribute Type</span> column across from <span class=\"cod\">Calendar Semester</span>. I clicked the drop-down arrow. I expanded the <span class=\"cod\">Date</span> entry. I expanded the <span class=\"cod\">Calendar</span> entry. I selected <span class=\"cod\">Half Year</span> and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectHalfYearAttributeType.jpg\" alt=\"Select Half Year Attribute Type\" width=\"615\" height=\"745\"></div><p>I clicked in the <span class=\"cod\">Attribute Type</span> column across from <span class=\"cod\">Day Of Week</span>. I clicked the drop-down arrow. I expanded the <span class=\"cod\">Date</span> entry. I expanded the <span class=\"cod\">Calendar</span> entry. I selected <span class=\"cod\">Day of Week</span> and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectDayOfWeekAttributeType.jpg\" alt=\"Select Day Of Week Attribute Type\" width=\"617\" height=\"761\"></div><p>I clicked in the <span class=\"cod\">Attribute Type</span> column across from <span class=\"cod\">Calendar Month</span>. I clicked the drop-down arrow. I expanded the <span class=\"cod\">Date</span> entry. I expanded the <span class=\"cod\">Calendar</span> entry. I selected <span class=\"cod\">Month</span> and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectMonthAttributeType.jpg\" alt=\"Select Month Attribute Type\" width=\"617\" height=\"781\"></div><p>I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectDimensionAttributes.jpg\" alt=\"Select Dimension Attributes\" width=\"555\" height=\"638\"></div><p>The <span class=\"cod\">Completing the Wizard</span> page appeared. I changed the name to <span class=\"cod\">Dim Time</span>. I clicked <span class=\"cod\">Finish</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/completeWizardForCreatingTimeDimension.jpg\" alt=\"Complete Wizard for creating Time Dimension\" width=\"555\" height=\"637\"></div><p>The <span class=\"cod\">Dimension Design</span> tab appeared with the <span class=\"cod\">Dim Time</span> dimension:</p><div><img src=\"/blog/2023/12/31/06/14/img/timeDimensionDesignTab.jpg\" alt=\"Time Dimension Design tab\" width=\"1914\" height=\"1027\"></div><p>I right-clicked the entry for <span class=\"cod\">Day ID</span> in the <span class=\"cod\">Attributes</span> area, and selected <span class=\"cod\">Rename</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/renameDimensionAttribute.jpg\" alt=\"Rename Dimension attribute\" width=\"1918\" height=\"1029\"></div><p>I entered <span class=\"cod\">Date</span> for the name of this attribute, and pressed <span class=\"cod\">ENTER</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/renamedAttribute.jpg\" alt=\"Renamed Attribute\" width=\"1916\" height=\"1029\"></div><p>I repeated the steps above to rename the other attributes as follows:</p><table><tr><th>Old name</th><th>New name</th></tr><tr><td>Calendar Month</td><td>Month</td></tr><tr><td>Calendar Quarter</td><td>Quarter</td></tr><tr><td>Calendar Semester</td><td>Semester</td></tr><tr><td>Calendar Year</td><td>Year</td></tr><tr><td>Day Of Week</td><td>Day of week</td></tr></table><div><img src=\"/blog/2023/12/31/06/14/img/renamedAttributes.jpg\" alt=\"Renamed attributes\" width=\"1912\" height=\"1025\"></div><p>I dragged the <span class=\"cod\">Year</span> item from the <span class=\"cod\">Attributes</span> column, and dropped it in the <span class=\"cod\">Hierarchies</span> area:</p><div><img src=\"/blog/2023/12/31/06/14/img/dragDateAndDropToHierarchiesArea.jpg\" alt=\"Drag Date and drop to hierarchies area\" width=\"1912\" height=\"1024\"></div><p>I dragged the <span class=\"cod\">Semester</span> item from the <span class=\"cod\">Attributes</span> column, and dropped it on <span class=\"cod\">&lt;new level&gt;</span> in the <span class=\"cod\">Hierarchies</span> area:</p><div><img src=\"/blog/2023/12/31/06/14/img/sendSemesterToHierarchy.jpg\" alt=\"Send Semester to Hierarchy\" width=\"851\" height=\"296\"></div><p>I repeated the steps above for <span class=\"cod\">Quarter</span>, <span class=\"cod\">Month</span>, <span class=\"cod\">Date of week</span>, and <span class=\"cod\">Date</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/sendAttributesToHierarchy.jpg\" alt=\"Send Attributes to Hierarchy\" width=\"853\" height=\"351\"></div><p>I right-clicked the word <span class=\"cod\">Hierarchy</span> in the <span class=\"cod\">Hierarchies</span> area, and selected <span class=\"cod\">Rename</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/renameHierarchy.jpg\" alt=\"Rename Hierarchy\" width=\"1919\" height=\"1029\"></div><p>I entered <span class=\"cod\">Date Hierarchy</span> and pressed <span class=\"cod\">ENTER</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/renameDateHierarchy.jpg\" alt=\"Rename Date Hierarchy\" width=\"851\" height=\"339\"></div><p>I clicked <span class=\"cod\">Month</span> in the <span class=\"cod\">Attributes</span> area. I held down <span class=\"cod\">SHIFT</span> and clicked <span class=\"cod\">Day of week</span> in the <span class=\"cod\">Attributes</span> area. All five attributes were selected:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectAllAttributes.jpg\" alt=\"Select all Attributes\" width=\"848\" height=\"336\"></div><p>In the <span class=\"cod\">Properties</span> window, I changed the <span class=\"cod\">AttributeHierarchyVisible</span> property to <span class=\"cod\">False</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/changeAttributeHierarchyVisibleToFalse.jpg\" alt=\"Change AttributeHierarchyVisible to False\" width=\"1915\" height=\"1024\"></div><p>I clicked the <span class=\"cod\">Attribute Relationships</span> tab. I noted the <span class=\"cod\">Date</span> was related to the other five items, but the relationship structure did not mirror the hierarchy I created:</p><div><img src=\"/blog/2023/12/31/06/14/img/showWrongAttributeRelationship.jpg\" alt=\"Show wrong Attribute Relationship\" width=\"1916\" height=\"1027\"></div><p>I selected the <span class=\"cod\">Day of week</span> and dropped it on the <span class=\"cod\">Month</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/defineAttributeRelationshipBetweenDayOfWeekAndMonth.jpg\" alt=\"Define Attribute Relationship between Day of week and Month\" width=\"729\" height=\"327\"></div><p>I selected the <span class=\"cod\">Month</span> and dropped it on the <span class=\"cod\">Quarter</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/defineAttributeRelationshipBetweenMonthAndQuarter.jpg\" alt=\"Define Attribute Relationship between Month and Quarter\" width=\"1915\" height=\"1024\"></div><p>I selected the <span class=\"cod\">Quarter</span> and dropped it on the <span class=\"cod\">Semester</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/defineAttributeRelationshipBetweenQuarterAndSemester.jpg\" alt=\"Define Attribute Relationship between Quarter and Semester\" width=\"1916\" height=\"1029\"></div><p>I selected the <span class=\"cod\">Semester</span> and dropped it on the <span class=\"cod\">Year</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/defineAttributeRelationshipBetweenSemesterAndYear.jpg\" alt=\"Define Attribute Relationship between Semester and Year\" width=\"955\" height=\"218\"></div><p>I right-clicked each of the relationship arrows, and selected <span class=\"cod\">Relationship Type | Rigid</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectRigidRelationshipType.jpg\" alt=\"Select Rigid Relationship Type\" width=\"1916\" height=\"1025\"></div><p>The arrows changed to a solid background:</p><div><img src=\"/blog/2023/12/31/06/14/img/arrowsWithSolidBackground.jpg\" alt=\"Arrows with solid background\" width=\"954\" height=\"230\"></div><p>In the <span class=\"cod\">Solution Explorer</span> window, I double-clicked the <span class=\"cod\">Fact Purchases X Dim Category.dim</span> dimension entry. The <span class=\"cod\">Fact Purchases X Dim Category.dim</span> dimension tab appeared:</p><div><img src=\"/blog/2023/12/31/06/14/img/showFactPurchasesXDimCategoryTab.jpg\" alt=\"Show FactPurchasesXDimCategory tab\" width=\"1918\" height=\"1027\"></div><p>I right-clicked the <span class=\"cod\">Bank ID</span> attribute in the <span class=\"cod\">Attributes</span> area and selected <span class=\"cod\">Rename</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/renameBankID.jpg\" alt=\"Rename Bank ID\" width=\"1919\" height=\"1029\"></div><p>I typed <span class=\"cod\">Bank</span> and pressed <span class=\"cod\">ENTER</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/renameBankIDToBank.jpg\" alt=\"Rename Bank ID to Bank\" width=\"1912\" height=\"1028\"></div><p>Having the <span class=\"cod\">Bank</span> attribute selected, I clicked the <span class=\"cod\">NameColumn</span> property in the <span class=\"cod\">Properties</span> window. Then I clicked the <span class=\"cod\">ellipsis (…)</span> button:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickNameColumnForBankAttribute.jpg\" alt=\"Click NameColumn for Bank attribute\" width=\"1918\" height=\"1030\"></div><p>The <span class=\"cod\">Name Column</span> dialog box appeared. In the <span class=\"cod\">Source column</span> area, I clicked <span class=\"cod\">BankName</span>. Then I clicked <span class=\"cod\">OK</span> to exit the <span class=\"cod\">Name Column</span> dialog box:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectBankName.jpg\" alt=\"Select BankName\" width=\"1919\" height=\"1030\"></div><p>The purpose of the previous step was to determine what value to display for this attribute. In this case, the <span class=\"cod\">BankID</span> was used to uniquely identify a member of the <span class=\"cod\">Bank</span> attribute. However, the <span class=\"cod\">BankName</span> is what is shown to the user as they use the <span class=\"cod\">Bank</span> attribute in a query. For that reason, I selected <span class=\"cod\">BankName</span> and not <span class=\"cod\">BankID</span>.</p><p>I repeated the steps above to modify the other attributes in the <span class=\"cod\">Fact Purchases X Dim Category</span> dimension as follows:</p><table><tr><th>Old name</th><th>New name</th><th>Name column - Source column</th></tr><tr><td>Card ID</td><td>Card</td><td>CardNumber</td></tr><tr><td>Card Brand ID</td><td>Card Brand</td><td>CardBrandName</td></tr><tr><td>Card Type ID</td><td>Card Type</td><td>CardTypeName</td></tr><tr><td>Category ID</td><td>Category</td><td>CategoryName</td></tr><tr><td>City ID</td><td>Composite Primary Key</td><td>CityID (useless but I selected one just because it was required)</td></tr><tr><td>Country ID</td><td>Country</td><td>CountryName</td></tr><tr><td>Day ID</td><td>Date</td><td>FullDateAlternateKey</td></tr><tr><td>Dim City - City ID</td><td>City</td><td>CityName</td></tr><tr><td>Parent Category ID</td><td>Parent Category</td><td>ParentCategoryName</td></tr><tr><td>Payment Method ID</td><td>Payment Method</td><td>PaymentMethodName</td></tr><tr><td>Province ID</td><td>Province</td><td>ProvinceName</td></tr><tr><td>Seller ID</td><td>Seller</td><td>SellerName</td></tr></table><p>The attributes were renamed and their corresponding <span class=\"cod\">NameColumn</span> values assigned:</p><div><img src=\"/blog/2023/12/31/06/14/img/renameDimensionAttributesAndAssignNameColumns.jpg\" alt=\"Rename dimension attributes and assign NameColumn\" width=\"1913\" height=\"1027\"></div><p>I created a new hierarchy and named it <span class=\"cod\">Bank Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Bank<li>Card</ul><div><img src=\"/blog/2023/12/31/06/14/img/createBankHierarchy.jpg\" alt=\"Create Bank Hierarchy\" width=\"1913\" height=\"1029\"></div><p>I created a second hierarchy and named it <span class=\"cod\">Card Type Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Card Type<li>Card<li>Payment Method</ul><div><img src=\"/blog/2023/12/31/06/14/img/createCardTypeHierarchy.jpg\" alt=\"Create Card Type Hierarchy\" width=\"1913\" height=\"1028\"></div><p>I created a third hierarchy and named it <span class=\"cod\">Card Brand Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Card Brand<li>Card<li>Payment Method</ul><div><img src=\"/blog/2023/12/31/06/14/img/createCardBrandHierarchy.jpg\" alt=\"Create Card Brand Hierarchy\" width=\"1913\" height=\"1027\"></div><p>I created a fourth hierarchy and named it <span class=\"cod\">Parent Category Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Parent Category<li>Category</ul><div><img src=\"/blog/2023/12/31/06/14/img/createParentCategoryHierarchy.jpg\" alt=\"Create Parent Category Hierarchy\" width=\"1917\" height=\"1030\"></div><p>I created a fifth hierarchy and named it <span class=\"cod\">Country Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Country<li>Province<li>City</ul><div><img src=\"/blog/2023/12/31/06/14/img/createCountryHierarchy.jpg\" alt=\"Create Country Hierarchy\" width=\"1911\" height=\"1026\"></div><p>I set the <span class=\"cod\">AttributeHierarchyVisible</span> property for all of the attributes to <span class=\"cod\">False</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/setAttributeHierarchyVisibleToFalse.jpg\" alt=\"Set AttributeHierarchyVisible to False\" width=\"1914\" height=\"1028\"></div><p>I selected the <span class=\"cod\">Attribute Relationships</span> tab:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectAttributeRelationshipsTab.jpg\" alt=\"Select AttributeRelationships tab\" width=\"1917\" height=\"1027\"></div><p>I changed all of the <span class=\"cod\">Relationship Types</span> to <span class=\"cod\">Rigid</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/setRelationshipTypeToRigid.jpg\" alt=\"Set Relationship Type to Rigid\" width=\"1915\" height=\"1028\"></div><p>I double-clicked the entry for <span class=\"cod\">FinancesDM.cube</span> to display the <span class=\"cod\">Cube Design</span> tab:</p><div><img src=\"/blog/2023/12/31/06/14/img/openCubeDesignTab.jpg\" alt=\"Open Cube Design tab\" width=\"1913\" height=\"1025\"></div><p>I selected the <span class=\"cod\">Dimension Usage</span> tab of the <span class=\"cod\">Cube Design</span> tab:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectDimensionUsage.jpg\" alt=\"Select Dimension Usage\" width=\"1912\" height=\"1026\"></div><p>I right-clicked in the empty area of the tab and selected <span class=\"cod\">Add Cube Dimension</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/addDimensionCube.jpg\" alt=\"Add Dimension Cube\" width=\"1917\" height=\"1029\"></div><p>The <span class=\"cod\">Add Cube Dimension</span> dialog box appeared. I selected the <span class=\"cod\">Dim Time</span> dimension, and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/addDimTimeCubeDimension.jpg\" alt=\"Add Dim Time Cube Dimension\" width=\"1914\" height=\"1027\"></div><p>The <span class=\"cod\">Dim Time</span> dimension was added to the cube:</p><div><img src=\"/blog/2023/12/31/06/14/img/dimTimeDimensionAddedToCube.jpg\" alt=\"Dim Time dimension added to cube\" width=\"1911\" height=\"1027\"></div><p>I clicked the entry in the <span class=\"cod\">Fact Purchases</span> column and the <span class=\"cod\">Dim Time</span> row. An <span class=\"cod\">ellipsis (…)</span> button appeared and I clicked it:</p><div><img src=\"/blog/2023/12/31/06/14/img/showEllipsis.jpg\" alt=\"Show ellipsis\" width=\"1917\" height=\"1029\"></div><p>The <span class=\"cod\">Define Relationship</span> dialog box appeared. I selected <span class=\"cod\">Regular</span> in the <span class=\"cod\">Select relationship type</span> drop-down list. I selected <span class=\"cod\">Date</span> from the <span class=\"cod\">Granularity attribute</span> drop-down list. In the <span class=\"cod\">Relationship</span> grid, I selected <span class=\"cod\">DayID</span> from the drop-down list under <span class=\"cod\">Measure Group Columns</span>. I clicked <span class=\"cod\">OK</span> to exit the <span class=\"cod\">Define Relationship</span> dialog box:</p><div><img src=\"/blog/2023/12/31/06/14/img/defineRelationshipForDimTimeDimension.jpg\" alt=\"Define Relationship for Dim Time dimension\" width=\"1915\" height=\"1028\"></div><p>The <span class=\"cod\">Dimension Usage</span> tab appeared as shown below:</p><div><img src=\"/blog/2023/12/31/06/14/img/showDateRelationship.jpg\" alt=\"Show Date Relationship\" width=\"1913\" height=\"1029\"></div><p>I processed and browsed the cube, applying all dimensions available against the <span class=\"cod\">Total Purchases</span> fact:</p><div><img src=\"/blog/2023/12/31/06/14/img/browseCubeDisplayingAllDimensions.jpg\" alt=\"Browse cube displaying all dimensions\" width=\"1917\" height=\"1026\"></div><p>While browsing the cube, I removed all dimensions and kept only the <span class=\"cod\">Total Purchases</span> fact. The result was the same total, $1,875.59 (compare screenshot above versus screenshot below):</p><div><img src=\"/blog/2023/12/31/06/14/img/showFactWithoutDistibutionByDimension.jpg\" alt=\"Show fact without distribution by dimension\" width=\"1913\" height=\"1027\"></div><p>I noticed that I was missing the <span class=\"cod\">Seller</span> dimension in my cube. I opened <span class=\"cod\">Fact Purchases X Dim Category.dim</span>. I dragged the <span class=\"cod\">Seller</span> item from the <span class=\"cod\">Attributes</span> column, and dropped it in the <span class=\"cod\">Hierarchies</span> area. I renamed this new hierarchy from <span class=\"cod\">Hierarchy</span> to <span class=\"cod\">Seller Hierarchy</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/addAttributeToHierarchy.jpg\" alt=\"Add Attribute to Hierarchy\" width=\"1915\" height=\"1026\"></div><p>I processed the <span class=\"cod\">Fact Purchases X Dim Category.dim</span> dimension, which contained the new <span class=\"cod\">Seller Hierarchy</span> that I created:</p><div><img src=\"/blog/2023/12/31/06/14/img/processDimensionToRecognizeNewHierarchy.jpg\" alt=\"Process dimension to recognize new hierarchy\" width=\"1919\" height=\"1029\"></div><p>I clicked <span class=\"cod\">Yes</span> to build and deploy the project:</p><div><img src=\"/blog/2023/12/31/06/14/img/buildAndDeployProject.jpg\" alt=\"Build and deploy project\" width=\"1913\" height=\"1028\"></div><p>I clicked <span class=\"cod\">Yes</span> to proceed with the deployment, overwriting the database:</p><div><img src=\"/blog/2023/12/31/06/14/img/deployAndOverwriteDatabase.jpg\" alt=\"Deploy and overwrite database\" width=\"1912\" height=\"1028\"></div><p>I clicked <span class=\"cod\">Run...</span> to start processing the dimension:</p><div><img src=\"/blog/2023/12/31/06/14/img/runToStartProcessingDimension.jpg\" alt=\"Run to start processing dimension\" width=\"1916\" height=\"1031\"></div><p>Processing <span class=\"cod\">Dimension 'Fact Purchases X Dim Category'</span>, <span class=\"cod\">Cube 'FinancesDM'</span>, and <span class=\"cod\">Measure Group 'Fact Purchases'</span> completed successfully:</p><div><img src=\"/blog/2023/12/31/06/14/img/cubeFactAndDimensionProcessedSuccessfully.jpg\" alt=\"Cube, Fact and Dimension processed successfully\" width=\"1913\" height=\"1027\"></div><p>Browsing the cube allowed me to display <span class=\"cod\">Total Purchases</span> by <span class=\"cod\">Seller</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/showTotalPurchasesBySeller.jpg\" alt=\"Show Total Purchases by Seller\" width=\"1912\" height=\"1027\"></div><p>I browsed the cube returning <span class=\"cod\">Total Purchases</span> by <span class=\"cod\">Seller</span>, by <span class=\"cod\">Parent Category</span>, by <span class=\"cod\">Category</span>, and by <span class=\"cod\">Date</span> (<span class=\"cod\">Year</span>, <span class=\"cod\">Semester</span>, <span class=\"cod\">Quarter</span>, <span class=\"cod\">Month</span>, <span class=\"cod\">Day of week</span>, and <span class=\"cod\">Date</span>):</p><div><img src=\"/blog/2023/12/31/06/14/img/browseTotalPurchasesByMultipleDimensions.jpg\" alt=\"Browse Total Purchases by multiple dimensions\" width=\"1916\" height=\"1026\"></div><p>I browsed the cube returning <span class=\"cod\">Total Purchases</span> by <span class=\"cod\">Parent Category</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/browseCubeDisplayingTotalPurchasesByParentCategory.jpg\" alt=\"Browse cube displaying Total Purchases by Parent Category\" width=\"1917\" height=\"1027\"></div><p>My cube was working correctly for my purchases. Next I needed to make it work the same way for my sales.</p><p>In the <span class=\"cod\">Measures</span> pane, I right-clicked <span class=\"cod\">FinancesDM</span>, my top and only node. Then I clicked <span class=\"cod\">New Measure...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNewMeasure.jpg\" alt=\"Create new measure\" width=\"1924\" height=\"1029\"></div><p>From the New Measure dialog box, I selected the following options and clicked <span class=\"cod\">OK</span>:</p><table><tr><th>Usage</th><th>Source table</th><th>Source column</th></tr><tr><td>Sum</td><td>FactSales</td><td>TotalSales</td></tr></table><div><img src=\"/blog/2023/12/31/06/14/img/provideValuesToUseForNewMeasure.jpg\" alt=\"Provide values to use for new measure\" width=\"1912\" height=\"1029\"></div><p>My new measure was created, for now not connected to any dimension:</p><div><img src=\"/blog/2023/12/31/06/14/img/newMeasureCreated.jpg\" alt=\"New measure created\" width=\"1913\" height=\"1026\"></div><p>I pretended I was going to create a new Cube, but my real intention was to use the <span class=\"cod\">Cube Wizard</span> in order to select new dimensions to be created, based on available tables. My intuition told me that it was more logical to use the <span class=\"cod\">Dimension Wizard</span> for the purpose of creating dimensions for my <span class=\"cod\">FactSales</span> measure, but this is as far as I could get, and I did not want to create a <span class=\"cod\">named calculation in the Data Source View</span> as suggested by the warning (<span class=\"cod\">A name column must be specified when a composite key is used. If not already present, it is recommended to create a named calculation in the Data Source View that concatenates the specified key columns.</span>) that did not let me continue (the <span class=\"cod\">Next</span> button was greyed out):</p><div><img src=\"/blog/2023/12/31/06/14/img/issueWhenTryingToCreateDimensionsFromDimensionWizard.jpg\" alt=\"Issue when trying to create dimensions from Dimension Wizard\" width=\"1916\" height=\"1030\"></div><p>I right-clicked <span class=\"cod\">Cubes</span> and then clicked <span class=\"cod\">New Cube...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNewFakeCube.jpg\" alt=\"Create new fake cube\" width=\"1915\" height=\"1028\"></div><p>The <span class=\"cod\">Cube Wizard</span> appeared. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickNextFromCubeWizard.jpg\" alt=\"Click Next from Cube Wizard\" width=\"1916\" height=\"1027\"></div><p>The <span class=\"cod\">Select Creation Method</span> page appeared. I kept <span class=\"cod\">Use existing tables</span> selected. Then I clicked Next:</p><div><img src=\"/blog/2023/12/31/06/14/img/useExistingTablesToCreateNewCube.jpg\" alt=\"Use existing tables to create new cube\" width=\"1917\" height=\"1028\"></div><p>The <span class=\"cod\">Select Measure Group Tables</span> page appeared. The <span class=\"cod\">FinancesDM</span> data source view that I created was selected. I checked <span class=\"cod\">FactSales</span> in the <span class=\"cod\">Measure group tables</span> area. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectFactSalesAsMeasureGroupTable.jpg\" alt=\"Select FactSales as Measure Group Table\" width=\"1917\" height=\"1029\"></div><p>The <span class=\"cod\">Select Measures</span> page appeared. The wizard found and checked the measure field in the <span class=\"cod\">FactSales</span> table. The wizard also added a field called <span class=\"cod\">Fact Sales Count</span>, which counts the number of records. This does not provide me with any useful information in this data mart, so I unchecked the <span class=\"cod\">Fact Sales Count</span> field. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectTotalSalesMeasure.jpg\" alt=\"Select TotalSales Measure\" width=\"1915\" height=\"1026\"></div><p>The <span class=\"cod\">Select Existing Dimensions</span> page appeared. I unchecked both of my existing dimensions: <span class=\"cod\">Fact Purchases X Dim Category</span> and <span class=\"cod\">Dim Time</span>. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/uncheckExistingDimensions.jpg\" alt=\"Uncheck existing dimensions\" width=\"1915\" height=\"1029\"></div><p>The <span class=\"cod\">Select New Dimensions</span> page appeared. The wizard found all of the tables related to the <span class=\"cod\">FactSales</span> table in the data source view. It also created hierarchies for the <span class=\"cod\">DimCity</span>, <span class=\"cod\">DimPaymentMethod</span>, and <span class=\"cod\">DimCategory</span> dimensions. I unchecked <span class=\"cod\">Fact Sales</span> and <span class=\"cod\">FactSales</span>. I clicked <span class=\"cod\">Next</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectDimensionsForFactSales.jpg\" alt=\"Select dimensions for FactSales\" width=\"1917\" height=\"1026\"></div><p>The <span class=\"cod\">Completing the Wizard</span> page appeared. I kept <span class=\"cod\">FinancesDM 1</span> for <span class=\"cod\">Cube name</span>. Then I clicked <span class=\"cod\">Finish</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/finishCreationOfNewCube.jpg\" alt=\"Finish creation of new cube\" width=\"1917\" height=\"1029\"></div><p>My new dimension (<span class=\"cod\">Fact Sales X Dim Category.dim</span>) appeared. I deleted the new cube (<span class=\"cod\">FinancesDM 1.cube</span>), since creating it was just a workaround for the real purpose of creating the <span class=\"cod\">Fact Sales X Dim Category.dim</span> dimension with the <span class=\"cod\">Cube Wizard</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/newDimensionCreatedWithCubeWizard.jpg\" alt=\"New dimension created with Cube Wizard\" width=\"1913\" height=\"1026\"></div><p>In the <span class=\"cod\">Solution Explorer</span> window, I double-clicked the <span class=\"cod\">Fact Sales X Dim Category.dim</span> dimension entry. The Fact <span class=\"cod\">Fact Sales X Dim Category.dim</span> dimension tab appeared:</p><div><img src=\"/blog/2023/12/31/06/14/img/openFactSalesXDimCategoryDesignTab.jpg\" alt=\"Open Fact Sales X Dim Category.dim dimension tab\" width=\"1914\" height=\"1029\"></div><p>I right-clicked the <span class=\"cod\">Bank ID</span> attribute in the <span class=\"cod\">Attributes</span> area and selected <span class=\"cod\">Rename</span> from the context menu:</p><div><img src=\"/blog/2023/12/31/06/14/img/renameBankIDAttribute.jpg\" alt=\"Rename Bank ID attribute\" width=\"1919\" height=\"1030\"></div><p>I typed <span class=\"cod\">Bank</span> and pressed <span class=\"cod\">ENTER</span>:<p><div><img src=\"/blog/2023/12/31/06/14/img/showRenamedAttribute.jpg\" alt=\"Show renamed attribute\" width=\"1915\" height=\"1029\"></div><p>Having the <span class=\"cod\">Bank</span> attribute selected, I clicked the <span class=\"cod\">NameColumn</span> property in the <span class=\"cod\">Properties</span> window. Then I clicked the <span class=\"cod\">ellipsis (…)</span> button:</p><div><img src=\"/blog/2023/12/31/06/14/img/defineNameColumnForBankAttribute.jpg\" alt=\"Define NameColumn for Bank attribute\" width=\"1919\" height=\"1030\"></div><p>The <span class=\"cod\">Name Column</span> dialog box appeared. In the <span class=\"cod\">Source column</span> area, I clicked <span class=\"cod\">BankName</span>. Then I clicked <span class=\"cod\">OK</span> to exit the <span class=\"cod\">Name Column</span> dialog box:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectBankNameFromNameColumnDialogBox.jpg\" alt=\"Select BankName from Name Column dialog box\" width=\"1916\" height=\"1030\"></div><p>I repeated the steps above to modify the other attributes in the <span class=\"cod\">Fact Sales X Dim Category</span> dimension as follows:</p><table><tr><th>Old name</th><th>New name</th><th>Name column - Source column</th></tr><tr><td>Buyer ID</td><td>Buyer</td><td>BuyerName</td></tr><tr><td>Card Brand ID</td><td>Card Brand</td><td>CardBrandName</td></tr><tr><td>Card ID</td><td>Card</td><td>CardNumber</td></tr><tr><td>Card Type ID</td><td>Card Type</td><td>CardTypeName</td></tr><tr><td>Category ID</td><td>Category</td><td>CategoryName</td></tr><tr><td>City ID</td><td>Composite Primary Key</td><td>CityID (useless but I selected one just because it was required)</td></tr><tr><td>Country ID</td><td>Country</td><td>CountryName</td></tr><tr><td>Day ID</td><td>Date</td><td>FullDateAlternateKey</td></tr><tr><td>Dim City - City ID</td><td>City</td><td>CityName</td></tr><tr><td>Parent Category ID</td><td>Parent Category</td><td>ParentCategoryName</td></tr><tr><td>Payment Method ID</td><td>Payment Method</td><td>PaymentMethodName</td></tr><tr><td>Province ID</td><td>Province</td><td>ProvinceName</td></tr></table><p>The attributes were renamed and their corresponding <span class=\"cod\">NameColumn</span> values assigned:</p><div><img src=\"/blog/2023/12/31/06/14/img/renamedAttributesForNewDimension.jpg\" alt=\"Renamed attributes for new dimension\" width=\"1916\" height=\"1026\"></div><p>I created a new hierarchy and named it <span class=\"cod\">Bank Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Bank<li>Card</ul><div><img src=\"/blog/2023/12/31/06/14/img/showBankHierarchy.jpg\" alt=\"Show Bank Hierarchy\" width=\"1915\" height=\"1029\"></div><p>I created a second hierarchy and named it <span class=\"cod\">Card Type Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Card Type<li>Card<li>Payment Method</ul><div><img src=\"/blog/2023/12/31/06/14/img/createCardTypeHierarchyForDimension.jpg\" alt=\"Create Card Type Hierarchy for dimension\" width=\"1916\" height=\"1029\"></div><p>I created a third hierarchy and named it <span class=\"cod\">Card Brand Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Card Brand<li>Card<li>Payment Method</ul><div><img src=\"/blog/2023/12/31/06/14/img/createCardBrandHierarchyForDimension.jpg\" alt=\"Create Card Brand Hierarchy for dimension\" width=\"1915\" height=\"1028\"></div><p>I created a fourth hierarchy and named it <span class=\"cod\">Parent Category Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Parent Category<li>Category</ul><div><img src=\"/blog/2023/12/31/06/14/img/createParentCategoryHierarchyForDimension.jpg\" alt=\"Create Parent Category Hierarchy for dimension\" width=\"1918\" height=\"1029\"></div><p>I created a fifth hierarchy and named it <span class=\"cod\">Country Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Country<li>Province<li>City</ul><div><img src=\"/blog/2023/12/31/06/14/img/createCountryHierarchyForDimension.jpg\" alt=\"Create Country Hierarchy for dimension\" width=\"1917\" height=\"1030\"></div><p>I created a sixth hierarchy and named it <span class=\"cod\">Buyer Hierarchy</span>. This hierarchy had the following levels:</p><ul><li>Buyer</ul><div><img src=\"/blog/2023/12/31/06/14/img/createBuyerHierarchy.jpg\" alt=\"Create Buyer Hierarchy for dimension\" width=\"1914\" height=\"1028\"></div><p>I set the <span class=\"cod\">AttributeHierarchyVisible</span> property for all of the attributes to <span class=\"cod\">False</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/setAttributeHierarchyVisibleToFalseForAllAttributes.jpg\" alt=\"Set AttributeHierarchyVisible to False for all attributes\" width=\"1916\" height=\"1028\"></div><p>I selected the <span class=\"cod\">Attribute Relationships</span> tab:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectAttributeRelationshipsTabForDimension.jpg\" alt=\"Select Attribute tab for dimension\" width=\"1918\" height=\"1028\"></div><p>I changed all of the <span class=\"cod\">Relationship Types</span> to <span class=\"cod\">Rigid</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/showSolidArrowsForRelationshipTypeRigid.jpg\" alt=\"Show solid arrows for Relationship Type Rigid\" width=\"1917\" height=\"1027\"></div><p>I double-clicked the entry for <span class=\"cod\">FinancesDM.cube</span> to display the <span class=\"cod\">Cube Design</span> tab:</p><div><img src=\"/blog/2023/12/31/06/14/img/openDesignTabOfCube.jpg\" alt=\"Open Design tab of cube\" width=\"1917\" height=\"1028\"></div><p>I selected the <span class=\"cod\">Dimension Usage</span> tab of the <span class=\"cod\">Cube Design</span> tab:</p><div><img src=\"/blog/2023/12/31/06/14/img/selectDimensionUsageTabOfCubeDesignTab.jpg\" alt=\"Select Dimension Usage tab of Cube Design tab\" width=\"1916\" height=\"1030\"></div><p>I clicked the entry in the <span class=\"cod\">Fact Sales</span> column and the <span class=\"cod\">Dim Time</span> row. An <span class=\"cod\">ellipsis (…)</span> button appeared and I clicked it:</p><div><img src=\"/blog/2023/12/31/06/14/img/ellipsisAppearingToConnectFactSalesToDimTime.jpg\" alt=\"Ellipsis appearing to connect Fact Sales to Dim Time\" width=\"1914\" height=\"1027\"></div><p>The <span class=\"cod\">Define Relationship</span> dialog box appeared. I selected <span class=\"cod\">Regular</span> in the <span class=\"cod\">Select relationship type</span> drop-down list. I selected <span class=\"cod\">Date</span> from the <span class=\"cod\">Granularity attribute</span> drop-down list. In the <span class=\"cod\">Relationship</span> grid, I selected <span class=\"cod\">DayID</span> from the drop-down list under <span class=\"cod\">Measure Group Columns</span>. I clicked <span class=\"cod\">OK</span> to exit the <span class=\"cod\">Define Relationship</span> dialog box:</p><div><img src=\"/blog/2023/12/31/06/14/img/defineRelationshipForTimeDimension.jpg\" alt=\"Define Relationship for Time dimension\" width=\"1916\" height=\"1030\"></div><p>The <span class=\"cod\">Dimension Usage</span> tab appeared as shown below:</p><div><img src=\"/blog/2023/12/31/06/14/img/LinkTimeDimensionToFactSalesMeasureGroup.jpg\" alt=\"Link Time Dimension to Fact Sales Measure Group\" width=\"1918\" height=\"1029\"></div><p>I right-clicked in the empty area of the tab and selected <span class=\"cod\">Add Cube Dimension</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/addCubeDimension.jpg\" alt=\"Add Cube Dimension\" width=\"1917\" height=\"1029\"></div><p>The <span class=\"cod\">Add Cube Dimension</span> dialog box appeared. I selected the <span class=\"cod\">Fact Sales X Dim Category</span> dimension, and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/addFactSalesXDimCategoryCubeDimension.jpg\" alt=\"Add Fact Sales X Dim Category Cube Dimension\" width=\"1919\" height=\"1028\"></div><p>The <span class=\"cod\">Fact Sales X Dim Category</span> dimension was added to the cube:</p><div><img src=\"/blog/2023/12/31/06/14/img/addFactSalesXDimCategoryDimension.jpg\" alt=\"Add Fact Sales X Dim Category dimension\" width=\"1913\" height=\"1029\"></div><p>I clicked the <span class=\"cod\">ellipsis (...)</span> that corresponded to the <span class=\"cod\">Composite Primary Key</span> that appeared in the intersection between the <span class=\"cod\">Fact Sales Measure Group</span>, and the <span class=\"cod\">Fact Sales X Dim Category Dimension</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickEllipsis.jpg\" alt=\"Click ellipsis\" width=\"1915\" height=\"1028\"></div><p>Everything was correct with the definition of the relationship:</p><div><img src=\"/blog/2023/12/31/06/14/img/correctDefinitionOfRelationship.jpg\" alt=\"Correct definition of relationship\" width=\"1917\" height=\"1028\"></div><p>I clicked the <span class=\"cod\">ellipsis (...)</span> that corresponded to the <span class=\"cod\">Composite Primary Key</span> that appeared in the intersection between the <span class=\"cod\">Fact Purchases Measure Group</span>, and the <span class=\"cod\">Fact Purchases X Dim Category Dimension</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickEllipsisForFactPurchasesAndFactPurchasesXDimCategory.jpg\" alt=\"Click ellipsis for Fact Purchases and Fact Purchases X Dim Category\" width=\"1917\" height=\"1029\"></div><p>Everything was correct with the definition of the relationship:</p><div><img src=\"/blog/2023/12/31/06/14/img/everythingOKWithCompositePrimaryKeyAttribute.jpg\" alt=\"Everything OK with Composite Primary Key attribute\" width=\"1914\" height=\"1030\"></div><p>I right-clicked <span class=\"cod\">FinancesDM.cube</span> and clicked <span class=\"cod\">Process...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/processCubeAgain.jpg\" alt=\"Process cube again\" width=\"1918\" height=\"1027\"></div><p>I clicked <span class=\"cod\">Yes</span> to build and deploy:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickYesToBuildAndDeploy.jpg\" alt=\"Click Yes to build and deploy\" width=\"1918\" height=\"1028\"></div><p>I clicked <span class=\"cod\">Yes</span> to overwrite the database:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickYesToOverwriteDatabase.jpg\" alt=\"Click Yes to overwrite database\" width=\"1919\" height=\"1030\"></div><p>I provided my username and password to connect to the database and clicked <span class=\"cod\">OK</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/provideUsernameAndPasswordToConnectToDatabase.jpg\" alt=\"Provide username and password to connect to database\" width=\"1917\" height=\"1031\"></div><p>I clicked <span class=\"cod\">Run...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/clickRun.jpg\" alt=\"Click Run...\" width=\"1912\" height=\"1027\"></div><p>The cube was processed successfully, which included processing <span class=\"cod\">Dimension 'Fact Sales X Dim Category'</span>, <span class=\"cod\">Measure Group 'Fact Purchases'</span>, and <span class=\"cod\">Measure Group 'Fact Sales'</span>. I clicked <span class=\"cod\">Close</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/processNewDimensionAndOldFacts.jpg\" alt=\"Process new Dimension and old Facts\" width=\"1914\" height=\"1032\"></div><p>I right-clicked <span class=\"cod\">FinancesDM.cube</span> and clicked <span class=\"cod\">Browse</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/browseProcessedCube.jpg\" alt=\"Browse processed cube\" width=\"1960\" height=\"1024\"></div><p>I browsed the cube applying all dimensions available against the <span class=\"cod\">Total Sales</span> fact:</p><div><img src=\"/blog/2023/12/31/06/14/img/browseCubeToSeeSales.jpg\" alt=\"Browse cube to see sales\" width=\"1916\" height=\"1028\"></div><p>I double-clicked FinancesDM.cube to see the structure of the cube in a diagram, with all of its facts (yellow header) and dimensions (blue header):</p><div><img src=\"/blog/2023/12/31/06/14/img/showStructureOfCubeInDiagram.jpg\" alt=\"Show structure of cube in diagram\" width=\"1917\" height=\"1027\"></div><p>Browsing the cube, I can answer questions such as, how much have I spent by city?:</p><div><img src=\"/blog/2023/12/31/06/14/img/distributionOfMoneySpentByCity.jpg\" alt=\"Distribution of money spent by city\" width=\"1920\" height=\"1029\"></div><p>How much have I spent by payment method?:</p><div><img src=\"/blog/2023/12/31/06/14/img/moneySpentByPaymentMethod.jpg\" alt=\"Distribution of money spent by payment method\" width=\"1913\" height=\"1026\"></div><p>How much have I spent by payment method and city?:</p><div><img src=\"/blog/2023/12/31/06/14/img/moneySpentByPaymentMethodAndCity.jpg\" alt=\"Distribution of money spent by city\" width=\"1917\" height=\"1025\"></div><p>I could discover how much money I had spent by a combination of multiple dimensions. For example, how much money have I spent by payment method and city and seller and date and category?:</p><div><img src=\"/blog/2023/12/31/06/14/img/moneySpentByACombinationOfMultipleDimensions.jpg\" alt=\"Money spent by a combination of multiple dimensions\" width=\"1919\" height=\"1028\"></div><p>How much money have I spent by date?</p><div><img src=\"/blog/2023/12/31/06/14/img/moneySpentByDate.jpg\" alt=\"Show money spent by date\" width=\"1915\" height=\"1028\"></div><p>The format of dates was difficult to read and ambiguous: Does <span class=\"cod\">Day of week = 1</span> mean <span class=\"cod\">Monday</span> or <span class=\"cod\">Sunday</span>? Does <span class=\"cod\">Date = 20231001</span> mean <span class=\"cod\">October 1st, 2023</span>; or <span class=\"cod\">January 10th, 2023</span>? For that reason, I had to find a better way to produce the time dimension.</p><p>I double-clicked <span class=\"cod\">FinancesDM.dsv</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/openDataSourceView.jpg\" alt=\"Open Data Source View\" width=\"1916\" height=\"1029\"></div><p>I right-clicked the <span class=\"cod\">DimDay</span> table and clicked <span class=\"cod\">New Named Calculation...</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNewNamedCalculation.jpg\" alt=\"Create new Named Calculation\" width=\"1917\" height=\"1030\"></div><p>I created two <span class=\"cod\">Named Calculations</span> with the following values:</p><table><tr><th>Colum name</th><th>Expression</th></tr><tr><td>Month</td><td>
<pre>
CASE
WHEN CalendarMonth = 1 THEN 'January'
WHEN CalendarMonth = 2 THEN 'February'
WHEN CalendarMonth = 3 THEN 'March'
WHEN CalendarMonth = 4 THEN 'April'
WHEN CalendarMonth = 5 THEN 'May'
WHEN CalendarMonth = 6 THEN 'June'
WHEN CalendarMonth = 7 THEN 'July'
WHEN CalendarMonth = 8 THEN 'August'
WHEN CalendarMonth = 9 THEN 'September'
WHEN CalendarMonth = 10 THEN 'October'
WHEN CalendarMonth = 11 THEN 'November'
WHEN CalendarMonth = 12 THEN 'December'
END
</pre>		   
		   </td></tr><tr><td>Day</td><td><span class=\"cod\">CONVERT(int, RIGHT(DayID, 2))</span></td></tr></table><p>I created the <span class=\"cod\">Named Calculation</span> for <span class=\"cod\">Month</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNamedCalculationForMonth.jpg\" alt=\"Create Named Calculation for Month\" width=\"1920\" height=\"1030\"></div><p>I created the <span class=\"cod\">Named Calculation</span> for <span class=\"cod\">Day</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/createNamedCalculationForDay.jpg\" alt=\"Create Named Calculation for Day\" width=\"1920\" height=\"1026\"></div><p>The new <span class=\"cod\">Named Calculations</span> appeared in the <span class=\"cod\">FinancesDM.dsv Data Source View</span> diagram:</p><div><img src=\"/blog/2023/12/31/06/14/img/calculatedColumnsInDataSourceView.jpg\" alt=\"Calculated columns in Data Source View\" width=\"1919\" height=\"1030\"></div><p>I right-clicked the <span class=\"cod\">DimDay</span> table and clicked <span class=\"cod\">Explore Data</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/exploreDataFromDataSourceView.jpg\" alt=\"Explore Data from Data Source View\" width=\"1916\" height=\"1028\"></div><p>The <span class=\"cod\">Explore DimDay Table</span> tab appeared with the corresponding results from the view:</p><div><img src=\"/blog/2023/12/31/06/14/img/exploreDimDayTable.jpg\" alt=\"Explore DimDay table\" width=\"1919\" height=\"1030\"></div><p>The results above were exactly the same as when running SELECT * FROM [Finances].[dbo].[DimDay] from <span class=\"cod\">SQL Server Management Studio</span>, except for the two <span class=\"cod\">Calculated Columns</span> (<span class=\"cod\">Month</span> and <span class=\"cod\">Day</span>):</p><div><img src=\"/blog/2023/12/31/06/14/img/exploreDimDayTableDataFromSQLServerManagementStudio.jpg\" alt=\"Explore DimDay table data from SQL Server Management Studio\" width=\"1920\" height=\"1029\"></div><p>I double-clicked <span class=\"cod\">FinancesDM.cube</span> to open the <span class=\"cod\">FinancesDM.cube [Design]</span> tab. The <span class=\"cod\">Calculated Columns</span> were included in the cube diagram:</p><div><img src=\"/blog/2023/12/31/06/14/img/includeCalculatedColumnsInCubeDiagram.jpg\" alt=\"Include Calculated Columns in cube diagram\" width=\"1917\" height=\"1028\"></div><p>I right-clicked <span class=\"cod\">Dim Time.dim</span> and clicked <span class=\"cod\">Delete</span>:</p><div><img src=\"/blog/2023/12/31/06/14/img/deleteTimeDimension.jpg\" alt=\"Delete Time dimension\" width=\"1918\" height=\"1030\"></div> <div>Published: 6:14 AM GMT · Dec 31, 2023</div>\n";
?>
